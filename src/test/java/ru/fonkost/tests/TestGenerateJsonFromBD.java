/** http://fonkost.ru */
package ru.fonkost.tests;

import static org.junit.Assert.assertTrue;

import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.List;

import org.junit.Test;

import ru.fonkost.entities.JsonPerson;
import ru.fonkost.main.GenerateJsonFromBD;

public class TestGenerateJsonFromBD {
    private static String checkStrAdam = "{id:\\\"person0\\\", name:\\\"Адам <br><a href='https://ru.wikipedia.org/wiki/%D0%90%D0%B4%D0%B0%D0%BC'>wiki</a>\\\", data:{ \\\"id\\\": \\\"1\\\", \\\"name\\\": \\\"Адам\\\", \\\"nameUrl\\\": \\\"null\\\", \\\"numGen\\\": \\\"0\\\" }, children:[{id:\\\"person0_1\\\", name:\\\"Каин <br><a href='https://ru.wikipedia.org/wiki/%D0%9A%D0%B0%D0%B8%D0%BD'>wiki</a>\\\", data:{ \\\"id\\\": \\\"3\\\", \\\"name\\\": \\\"Каин\\\", \\\"nameUrl\\\": \\\"Каин\\\", \\\"numGen\\\": \\\"1\\\" }, children:[{id:\\\"person0_1_4\\\", name:\\\"Енох <br><a href='https://ru.wikipedia.org/wiki/%D0%95%D0%BD%D0%BE%D1%85_(%D1%81%D1%8B%D0%BD_%D0%9A%D0%B0%D0%B8%D0%BD%D0%B0)'>wiki</a>\\\", data:{ \\\"id\\\": \\\"7\\\", \\\"name\\\": \\\"Енох (сын Каина)\\\", \\\"nameUrl\\\": \\\"Енох\\\", \\\"numGen\\\": \\\"2\\\" }, children:[]}]}, {id:\\\"person0_2\\\", name:\\\"Авель <br><a href='https://ru.wikipedia.org/wiki/%D0%90%D0%B2%D0%B5%D0%BB%D1%8C'>wiki</a>\\\", data:{ \\\"id\\\": \\\"4\\\", \\\"name\\\": \\\"Авель\\\", \\\"nameUrl\\\": \\\"Авель\\\", \\\"numGen\\\": \\\"1\\\" }, children:[]}, {id:\\\"person0_3\\\", name:\\\"Сиф <br><a href='https://ru.wikipedia.org/wiki/%D0%A1%D0%B8%D1%84'>wiki</a>\\\", data:{ \\\"id\\\": \\\"5\\\", \\\"name\\\": \\\"Сиф\\\", \\\"nameUrl\\\": \\\"Сиф\\\", \\\"numGen\\\": \\\"1\\\" }, children:[{id:\\\"person0_3_5\\\", name:\\\"Енос <br><a href='https://ru.wikipedia.org/wiki/%D0%95%D0%BD%D0%BE%D1%81'>wiki</a>\\\", data:{ \\\"id\\\": \\\"10\\\", \\\"name\\\": \\\"Енос\\\", \\\"nameUrl\\\": \\\"Енос\\\", \\\"numGen\\\": \\\"2\\\" }, children:[{id:\\\"person0_3_5_6\\\", name:\\\"Каинан <br><a href='https://ru.wikipedia.org/wiki/%D0%9A%D0%B0%D0%B8%D0%BD%D0%B0%D0%BD,_%D1%81%D1%8B%D0%BD_%D0%95%D0%BD%D0%BE%D1%81%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"13\\\", \\\"name\\\": \\\"Каинан, сын Еноса\\\", \\\"nameUrl\\\": \\\"Каинан\\\", \\\"numGen\\\": \\\"3\\\" }, children:[{id:\\\"person0_3_5_6_7\\\", name:\\\"Малелеил <br><a href='https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D0%BB%D0%B5%D0%BB%D0%B5%D0%B8%D0%BB'>wiki</a>\\\", data:{ \\\"id\\\": \\\"15\\\", \\\"name\\\": \\\"Малелеил\\\", \\\"nameUrl\\\": \\\"Малелеил\\\", \\\"numGen\\\": \\\"4\\\" }, children:[{id:\\\"person0_3_5_6_7_8\\\", name:\\\"Иаред <br><a href='https://ru.wikipedia.org/wiki/%D0%98%D0%B0%D1%80%D0%B5%D0%B4'>wiki</a>\\\", data:{ \\\"id\\\": \\\"17\\\", \\\"name\\\": \\\"Иаред\\\", \\\"nameUrl\\\": \\\"Иаред\\\", \\\"numGen\\\": \\\"5\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9\\\", name:\\\"Енох <br><a href='https://ru.wikipedia.org/wiki/%D0%95%D0%BD%D0%BE%D1%85,_%D1%81%D1%8B%D0%BD_%D0%98%D0%B0%D1%80%D0%B5%D0%B4%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"19\\\", \\\"name\\\": \\\"Енох, сын Иареда\\\", \\\"nameUrl\\\": \\\"Енох\\\", \\\"numGen\\\": \\\"6\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10\\\", name:\\\"Мафусаил <br><a href='https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D1%84%D1%83%D1%81%D0%B0%D0%B8%D0%BB'>wiki</a>\\\", data:{ \\\"id\\\": \\\"21\\\", \\\"name\\\": \\\"Мафусаил\\\", \\\"nameUrl\\\": \\\"Мафусаил\\\", \\\"numGen\\\": \\\"7\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11\\\", name:\\\"Ламех <br><a href='https://ru.wikipedia.org/wiki/%D0%9B%D0%B0%D0%BC%D0%B5%D1%85'>wiki</a>\\\", data:{ \\\"id\\\": \\\"23\\\", \\\"name\\\": \\\"Ламех\\\", \\\"nameUrl\\\": \\\"Ламех\\\", \\\"numGen\\\": \\\"8\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12\\\", name:\\\"Ной <br><a href='https://ru.wikipedia.org/wiki/%D0%9D%D0%BE%D0%B9'>wiki</a>\\\", data:{ \\\"id\\\": \\\"25\\\", \\\"name\\\": \\\"Ной\\\", \\\"nameUrl\\\": \\\"Ной\\\", \\\"numGen\\\": \\\"9\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_13\\\", name:\\\"Сим <br><a href='https://ru.wikipedia.org/wiki/%D0%A1%D0%B8%D0%BC'>wiki</a>\\\", data:{ \\\"id\\\": \\\"27\\\", \\\"name\\\": \\\"Сим\\\", \\\"nameUrl\\\": \\\"Сим\\\", \\\"numGen\\\": \\\"10\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_13_16\\\", name:\\\"Арфаксад <br><a href='https://ru.wikipedia.org/wiki/%D0%90%D1%80%D1%84%D0%B0%D0%BA%D1%81%D0%B0%D0%B4_(%D1%81%D1%8B%D0%BD_%D0%A1%D0%B8%D0%BC%D0%B0)'>wiki</a>\\\", data:{ \\\"id\\\": \\\"31\\\", \\\"name\\\": \\\"Арфаксад (сын Сима)\\\", \\\"nameUrl\\\": \\\"Арфаксад\\\", \\\"numGen\\\": \\\"11\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_13_16_27\\\", name:\\\"Каинан <br><a href='https://ru.wikipedia.org/wiki/%D0%9A%D0%B0%D0%B8%D0%BD%D0%B0%D0%BD,_%D1%81%D1%8B%D0%BD_%D0%90%D1%80%D1%84%D0%B0%D0%BA%D1%81%D0%B0%D0%B4%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"45\\\", \\\"name\\\": \\\"Каинан, сын Арфаксада\\\", \\\"nameUrl\\\": \\\"Каинан\\\", \\\"numGen\\\": \\\"12\\\" }, children:[]}]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_13_17\\\", name:\\\"Арам, сын Сима <br><a href='https://ru.wikipedia.org/wiki/%D0%90%D1%80%D0%B0%D0%BC,_%D1%81%D1%8B%D0%BD_%D0%A1%D0%B8%D0%BC%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"32\\\", \\\"name\\\": \\\"Арам, сын Сима\\\", \\\"nameUrl\\\": \\\"Арам, сын Сима\\\", \\\"numGen\\\": \\\"11\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_13_17_28\\\", name:\\\"Уц <br><a href='https://ru.wikipedia.org/wiki/%D0%A3%D1%86,_%D1%81%D1%8B%D0%BD_%D0%90%D1%80%D0%B0%D0%BC%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"47\\\", \\\"name\\\": \\\"Уц, сын Арама\\\", \\\"nameUrl\\\": \\\"Уц\\\", \\\"numGen\\\": \\\"12\\\" }, children:[]}]}]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_14\\\", name:\\\"Хам <br><a href='https://ru.wikipedia.org/wiki/%D0%A5%D0%B0%D0%BC'>wiki</a>\\\", data:{ \\\"id\\\": \\\"28\\\", \\\"name\\\": \\\"Хам\\\", \\\"nameUrl\\\": \\\"Хам\\\", \\\"numGen\\\": \\\"10\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_14_18\\\", name:\\\"Хуш <br><a href='https://ru.wikipedia.org/wiki/%D0%A5%D1%83%D1%88'>wiki</a>\\\", data:{ \\\"id\\\": \\\"34\\\", \\\"name\\\": \\\"Хуш\\\", \\\"nameUrl\\\": \\\"Хуш\\\", \\\"numGen\\\": \\\"11\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_14_18_29\\\", name:\\\"Нимрод <br><a href='https://ru.wikipedia.org/wiki/%D0%9D%D0%B8%D0%BC%D1%80%D0%BE%D0%B4'>wiki</a>\\\", data:{ \\\"id\\\": \\\"49\\\", \\\"name\\\": \\\"Нимрод\\\", \\\"nameUrl\\\": \\\"Нимрод\\\", \\\"numGen\\\": \\\"12\\\" }, children:[]}]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_14_19\\\", name:\\\"Ханаан, сын Хама <br><a href='https://ru.wikipedia.org/wiki/%D0%A5%D0%B0%D0%BD%D0%B0%D0%B0%D0%BD,_%D1%81%D1%8B%D0%BD_%D0%A5%D0%B0%D0%BC%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"35\\\", \\\"name\\\": \\\"Ханаан, сын Хама\\\", \\\"nameUrl\\\": \\\"Ханаан, сын Хама\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_14_20\\\", name:\\\"Мицраим <br><a href='https://ru.wikipedia.org/wiki/%D0%9C%D0%B8%D1%86%D1%80%D0%B0%D0%B8%D0%BC'>wiki</a>\\\", data:{ \\\"id\\\": \\\"36\\\", \\\"name\\\": \\\"Мицраим\\\", \\\"nameUrl\\\": \\\"Мицраим\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_14_21\\\", name:\\\"Фут, сын Хама <br><a href='https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D1%82,_%D1%81%D1%8B%D0%BD_%D0%A5%D0%B0%D0%BC%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"37\\\", \\\"name\\\": \\\"Фут, сын Хама\\\", \\\"nameUrl\\\": \\\"Фут, сын Хама\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_15\\\", name:\\\"Иафет <br><a href='https://ru.wikipedia.org/wiki/%D0%98%D0%B0%D1%84%D0%B5%D1%82'>wiki</a>\\\", data:{ \\\"id\\\": \\\"29\\\", \\\"name\\\": \\\"Иафет\\\", \\\"nameUrl\\\": \\\"Иафет\\\", \\\"numGen\\\": \\\"10\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_15_22\\\", name:\\\"Мадай <br><a href='https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D0%B4%D0%B0%D0%B9'>wiki</a>\\\", data:{ \\\"id\\\": \\\"39\\\", \\\"name\\\": \\\"Мадай\\\", \\\"nameUrl\\\": \\\"Мадай\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_15_23\\\", name:\\\"Иаван <br><a href='https://ru.wikipedia.org/wiki/%D0%98%D0%B0%D0%B2%D0%B0%D0%BD'>wiki</a>\\\", data:{ \\\"id\\\": \\\"40\\\", \\\"name\\\": \\\"Иаван\\\", \\\"nameUrl\\\": \\\"Иаван\\\", \\\"numGen\\\": \\\"11\\\" }, children:[{id:\\\"person0_3_5_6_7_8_9_10_11_12_15_23_30\\\", name:\\\"Елиса <br><a href='https://ru.wikipedia.org/wiki/%D0%95%D0%BB%D0%B8%D1%81%D0%B0'>wiki</a>\\\", data:{ \\\"id\\\": \\\"55\\\", \\\"name\\\": \\\"Елиса\\\", \\\"nameUrl\\\": \\\"Елиса\\\", \\\"numGen\\\": \\\"12\\\" }, children:[]}]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_15_24\\\", name:\\\"Фувал <br><a href='https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%B2%D0%B0%D0%BB'>wiki</a>\\\", data:{ \\\"id\\\": \\\"41\\\", \\\"name\\\": \\\"Фувал\\\", \\\"nameUrl\\\": \\\"Фувал\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_15_25\\\", name:\\\"Мешех <br><a href='https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%88%D0%B5%D1%85'>wiki</a>\\\", data:{ \\\"id\\\": \\\"42\\\", \\\"name\\\": \\\"Мешех\\\", \\\"nameUrl\\\": \\\"Мешех\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}, {id:\\\"person0_3_5_6_7_8_9_10_11_12_15_26\\\", name:\\\"Фирас <br><a href='https://ru.wikipedia.org/wiki/%D0%A4%D0%B8%D1%80%D0%B0%D1%81'>wiki</a>\\\", data:{ \\\"id\\\": \\\"43\\\", \\\"name\\\": \\\"Фирас\\\", \\\"nameUrl\\\": \\\"Фирас\\\", \\\"numGen\\\": \\\"11\\\" }, children:[]}]}]}]}]}]}]}]}]}]}]}]}";

    @Test
    public void testIncorrectArguments() throws Exception {
	new GenerateJsonFromBD();
	try {
	    GenerateJsonFromBD.main(null);
	} catch (IllegalArgumentException ex) {
	    assertTrue(ex.getMessage().equals("Must be two parameters"));
	}

	try {
	    GenerateJsonFromBD.main(new String[] { "first" });
	} catch (IllegalArgumentException ex) {
	    assertTrue(ex.getMessage().equals("Must be two parameters"));
	}
    }

    @Test
    public void testSaveTreeAdam() throws Exception {
	JsonPerson.resetCount();
	String filename = "C:\\workspace\\temp\\20170910_adam.json";
	GenerateJsonFromBD.main(new String[] { "20170910_adam", "adam" });
	List<String> lines = Files.readAllLines(Paths.get(filename), StandardCharsets.UTF_8);
	assertTrue(lines.size() == 1);
	assertTrue(lines.get(0).equals(checkStrAdam));
    }
}